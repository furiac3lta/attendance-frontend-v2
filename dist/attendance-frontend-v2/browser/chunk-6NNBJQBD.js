import{a as F}from"./chunk-JDDZ2UBL.js";import{a as j}from"./chunk-QJGRYSSM.js";import{b as P,c as R}from"./chunk-SKV5MVK2.js";import{a as B,b as D,e as G}from"./chunk-A3HJGCKZ.js";import{b as x,d as l,f as E,g as C,j as I,k as y,l as w,q as L,s as N}from"./chunk-RLT3B664.js";import{c as h}from"./chunk-5JTNXZA4.js";import"./chunk-FOSQZ4YM.js";import{a as A,b as _}from"./chunk-4TOFOFSS.js";import{b as v,d as S,e as b,f as M}from"./chunk-V33OWUZQ.js";import{Ca as u,Gb as e,Ka as m,Qa as d,e as T,fb as p,gb as i,hb as o,ib as a,rb as f,vc as g}from"./chunk-EKT4D7I2.js";var s=T(j());var k=class c{constructor(r,t,n){this.fb=r;this.authService=t;this.router=n;this.loginForm=this.fb.group({email:["",[l.required,l.email]],password:["",l.required]})}loginForm;isLoading=!1;onSubmit(){if(this.loginForm.invalid){s.default.fire({icon:"warning",title:"Formulario incompleto",text:"Complet\xE1 todos los campos correctamente.",heightAuto:!1});return}this.isLoading=!0,this.authService.login(this.loginForm.value).subscribe({next:r=>{sessionStorage.setItem("token",r.token),sessionStorage.setItem("role",r.type);let t=r.type?.replace(/^ROLE_/,"").toUpperCase();s.default.fire({icon:"success",title:"Bienvenido",text:`Hola ${t.replace("_"," ")}`,timer:1500,showConfirmButton:!1,heightAuto:!1}),this.router.navigate(["/dashboard"])},error:r=>{console.error("\u274C Error de login:",r);let t="\u274C Error de conexi\xF3n con el servidor.";r.status===401?t="\u26A0\uFE0F Usuario o contrase\xF1a incorrectos.":r.status===403&&(t="\u26D4 Tu cuenta no tiene permisos para ingresar."),s.default.fire({icon:"error",title:"Error al iniciar sesi\xF3n",text:t,heightAuto:!1})},complete:()=>{this.isLoading=!1}})}static \u0275fac=function(t){return new(t||c)(m(L),m(F),m(h))};static \u0275cmp=d({type:c,selectors:[["app-login-page"]],decls:31,vars:2,consts:[[1,"login-wrapper"],[1,"login-card"],[1,"title"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","type","email","formControlName","email","autocomplete","email"],["matSuffix",""],["matInput","","type","password","formControlName","password","autocomplete","current-password"],["mat-raised-button","","color","primary","type","submit",1,"login-button",3,"disabled"],[1,"login-footer"],["href","https://instagram.com/marcelocolum","target","_blank"]],template:function(t,n){t&1&&(i(0,"div",0)(1,"mat-card",1)(2,"h2",2),e(3,"Login"),o(),i(4,"form",3),f("ngSubmit",function(){return n.onSubmit()}),i(5,"mat-form-field",4)(6,"mat-label"),e(7,"Email"),o(),a(8,"input",5),i(9,"mat-icon",6),e(10,"mail"),o()(),i(11,"mat-form-field",4)(12,"mat-label"),e(13,"Contrase\xF1a"),o(),a(14,"input",7),i(15,"mat-icon",6),e(16,"lock"),o()(),i(17,"button",8)(18,"mat-icon"),e(19,"login"),o(),e(20," Entrar "),o()()()(),i(21,"footer",9)(22,"p"),e(23," Sistema de asistencias desarrollado por "),i(24,"strong"),e(25,"MarceDev"),o(),a(26,"br"),i(27,"a",10),e(28,"@marcelocolum"),o(),a(29,"br"),e(30," \xA9 2025 Todos los derechos reservados "),o()()),t&2&&(u(4),p("formGroup",n.loginForm),u(13),p("disabled",n.loginForm.invalid))},dependencies:[g,N,I,x,E,C,y,w,_,A,R,P,G,B,D,M,b,S,v],encapsulation:2})};export{k as LoginPage};
