import{a as M,b as y}from"./chunk-WULEXDEC.js";import{a as q}from"./chunk-WOQCSS36.js";import{a as Q}from"./chunk-CMBHYV4C.js";import{l as se,n as ce,o as me}from"./chunk-WEUNGTCO.js";import"./chunk-SKV5MVK2.js";import{e as Y}from"./chunk-A3HJGCKZ.js";import{f as $,i as H,r as G}from"./chunk-RLT3B664.js";import{b as le}from"./chunk-QO7BDAEL.js";import{a as K,b as Z,c as J,d as X,e as ee,f as te,g as re,h as ie,i as ne,j as oe,k as ae}from"./chunk-GV56X2P2.js";import"./chunk-XODYYG4P.js";import{c as N}from"./chunk-5JTNXZA4.js";import"./chunk-FOSQZ4YM.js";import{a as j}from"./chunk-4TOFOFSS.js";import{a as W,b as V,d as B,e as z,f as U}from"./chunk-V33OWUZQ.js";import{Ca as a,Gb as o,Ib as g,Ka as C,Kb as E,Lb as k,Mb as L,Pb as x,Qa as T,Ra as O,Ua as m,Z as I,a as P,b as w,fa as f,fb as l,fd as F,ga as h,gb as i,hb as n,ib as S,mb as p,nb as u,pb as b,pc as R,qc as A,rb as v,sb as _,vc as D}from"./chunk-EKT4D7I2.js";var de=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=O({type:e});static \u0275inj=I({imports:[F]})}return e})();var pe=()=>["name","description","program","instructor","assign","actions"];function fe(e,t){e&1&&(i(0,"div",18)(1,"mat-icon"),o(2,"info"),n(),o(3," No hay cursos disponibles para tu organizaci\xF3n. "),n())}function he(e,t){e&1&&(i(0,"th",19),o(1," Nombre "),n())}function ve(e,t){if(e&1&&(i(0,"td",20),o(1),n()),e&2){let r=t.$implicit;a(),g(" ",r.name," ")}}function Ce(e,t){e&1&&(i(0,"th",19),o(1," Descripci\xF3n "),n())}function Se(e,t){if(e&1&&(i(0,"td",20),o(1),n()),e&2){let r=t.$implicit;a(),g(" ",r.description," ")}}function Te(e,t){e&1&&(i(0,"th",19),o(1," Programa "),n())}function be(e,t){if(e&1&&(i(0,"td",20),o(1),n()),e&2){let r=t.$implicit;a(),g(" ",r.universityProgram," ")}}function xe(e,t){e&1&&(i(0,"th",19),o(1," Instructor actual "),n())}function Me(e,t){if(e&1&&(p(0),o(1),u()),e&2){let r=_().$implicit;a(),g(" ",r.instructorName," ")}}function ye(e,t){e&1&&(i(0,"span",23),o(1," Sin asignar "),n())}function Pe(e,t){if(e&1&&(i(0,"td",20),m(1,Me,2,1,"ng-container",21)(2,ye,2,0,"span",22),n()),e&2){let r=t.$implicit;a(),l("ngIf",r.instructorName&&r.instructorName!=="Sin asignar"),a(),l("ngIf",!r.instructorName||r.instructorName==="Sin asignar")}}function we(e,t){e&1&&(i(0,"th",19),o(1," Asignar Instructor "),n())}function Ie(e,t){if(e&1&&(i(0,"mat-option",27),o(1),n()),e&2){let r=t.$implicit;l("value",r.id),a(),g(" ",r.fullName," ")}}function Oe(e,t){if(e&1){let r=b();i(0,"td",20)(1,"div",24)(2,"mat-form-field",25)(3,"mat-select",26),L("ngModelChange",function(c){let d=f(r).$implicit;return k(d.selectedInstructorId,c)||(d.selectedInstructorId=c),h(c)}),i(4,"mat-option",27),o(5,"Sin asignar"),n(),m(6,Ie,2,2,"mat-option",28),n()(),i(7,"button",29),v("click",function(){let c=f(r).$implicit,d=_();return h(d.saveInstructor(c.id,c.selectedInstructorId))}),i(8,"mat-icon",30),o(9,"save"),n()()()()}if(e&2){let r=t.$implicit,s=_();a(3),E("ngModel",r.selectedInstructorId),a(),l("value",null),a(2),l("ngForOf",s.instructors),a(),l("disabled",!r.selectedInstructorId)}}function Ee(e,t){e&1&&(i(0,"th",19),o(1," Acciones "),n())}function ke(e,t){if(e&1){let r=b();i(0,"td",20)(1,"div",24)(2,"button",31),v("click",function(){let c=f(r).$implicit,d=_();return h(d.goToAttendance(c.id))}),i(3,"mat-icon",32),o(4,"assignment"),n()(),i(5,"button",33),v("click",function(){let c=f(r).$implicit,d=_();return h(d.goToReport(c.id))}),i(6,"mat-icon",34),o(7,"bar_chart"),n()()()()}}function Le(e,t){e&1&&S(0,"tr",35)}function Re(e,t){e&1&&S(0,"tr",36)}var ue=class e{constructor(t,r,s){this.router=t;this.coursesSvc=r;this.usersSvc=s}courses=[];message="";loading=!0;instructors=[];ngOnInit(){this.loadCourses(),this.loadInstructors()}loadCourses(){this.coursesSvc.findAll().subscribe({next:t=>{this.loading=!1,this.courses=t.map(r=>w(P({},r),{selectedInstructorId:r.instructorId??null}))},error:()=>{this.message="\u274C Error al obtener los cursos",this.loading=!1}})}canTakeAttendance(){let t=sessionStorage.getItem("role")?.replace("ROLE_","")??"";return["SUPER_ADMIN","ADMIN","INSTRUCTOR"].includes(t.toUpperCase())}goToAttendance(t){this.router.navigate([`/attendance/class/${t}`])}goToCreateCourse(){this.router.navigate(["/courses/new"])}loadInstructors(){this.usersSvc.getInstructors().subscribe({next:t=>this.instructors=t??[],error:t=>console.error(t)})}onAssignInstructor(t,r){let s=Number(r.target.value);this.coursesSvc.assignInstructor(t,s).subscribe({next:()=>{this.loadCourses()},error:c=>console.error("\u274C Error asignando instructor:",c)})}saveInstructor(t,r){r&&this.coursesSvc.assignInstructor(t,r).subscribe({next:()=>{this.loadCourses()},error:s=>console.error("\u274C Error asignando instructor",s)})}goToReport(t){this.router.navigate(["/attendance/report",t])}static \u0275fac=function(r){return new(r||e)(C(N),C(q),C(Q))};static \u0275cmp=T({type:e,selectors:[["app-course-list-page"]],decls:32,vars:6,consts:[[1,"page-card"],[1,"title"],[1,"actions"],["mat-raised-button","","color","primary",3,"click"],["class","empty",4,"ngIf"],[1,"table-section"],[1,"table-scroll-wrapper"],["mat-table","",1,"table-modern","responsive-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","program"],["matColumnDef","instructor"],["matColumnDef","assign"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"empty"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[1,"actions-inline"],["appearance","outline",1,"assign-select"],["placeholder","Seleccionar",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","Guardar instructor",3,"click","disabled"],[1,"icon-save"],["mat-icon-button","","matTooltip","Tomar asistencia",3,"click"],[1,"icon-attendance"],["mat-icon-button","","matTooltip","Ver reporte",3,"click"],[1,"icon-report"],["mat-header-row",""],["mat-row",""]],template:function(r,s){r&1&&(i(0,"mat-card",0)(1,"h2",1),o(2,"Gesti\xF3n de Cursos"),n(),i(3,"div",2)(4,"button",3),v("click",function(){return s.goToCreateCourse()}),i(5,"mat-icon"),o(6,"add"),n(),o(7," Nuevo curso "),n()(),m(8,fe,4,0,"div",4),i(9,"div",5)(10,"div",6)(11,"table",7),p(12,8),m(13,he,2,0,"th",9)(14,ve,2,1,"td",10),u(),p(15,11),m(16,Ce,2,0,"th",9)(17,Se,2,1,"td",10),u(),p(18,12),m(19,Te,2,0,"th",9)(20,be,2,1,"td",10),u(),p(21,13),m(22,xe,2,0,"th",9)(23,Pe,3,2,"td",10),u(),p(24,14),m(25,we,2,0,"th",9)(26,Oe,10,4,"td",10),u(),p(27,15),m(28,Ee,2,0,"th",9)(29,ke,8,0,"td",10),u(),m(30,Le,1,0,"tr",16)(31,Re,1,0,"tr",17),n()()()()),r&2&&(a(8),l("ngIf",s.courses.length===0),a(3),l("dataSource",s.courses),a(19),l("matHeaderRowDef",x(4,pe)),a(),l("matRowDefColumns",x(5,pe)))},dependencies:[D,R,A,G,$,H,ae,K,J,re,X,Z,ie,ee,te,ne,oe,B,V,W,U,z,me,Y,ce,se,y,M,le,de,j],styles:[".page-card[_ngcontent-%COMP%]{padding:3rem;margin-top:1rem;position:relative}.actions[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;gap:10px}.table-section[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;margin-top:1rem}.table-scroll-wrapper[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.table-modern[_ngcontent-%COMP%]{width:100%;min-width:850px;border-collapse:collapse}.assign-select[_ngcontent-%COMP%]{min-width:160px}.actions-inline[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.icon-save[_ngcontent-%COMP%]{color:#7c3aed!important;transition:.2s ease}.icon-save[_ngcontent-%COMP%]:hover{color:#5b21b6!important;transform:scale(1.15)}.icon-attendance[_ngcontent-%COMP%]{color:#ff4db2!important;transition:.2s ease}.icon-attendance[_ngcontent-%COMP%]:hover{color:#d9368e!important;transform:scale(1.15)}.icon-report[_ngcontent-%COMP%]{color:#ff4e4e!important;transition:.2s ease}.icon-report[_ngcontent-%COMP%]:hover{color:#d63a3a!important;transform:scale(1.15)}.text-muted[_ngcontent-%COMP%]{color:#777}.mat-row[_ngcontent-%COMP%]:hover{background:#f5f5f5;transition:.2s ease}.mat-icon[_ngcontent-%COMP%]{font-size:22px!important}"]})};export{ue as CourseListPage};
